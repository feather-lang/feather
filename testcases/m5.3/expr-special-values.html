<test-suite>
  <!--
    M6: IEEE 754 special floating-point values in expr
    
    This tests that expr properly handles division by zero to produce
    Inf, -Inf, and NaN values according to IEEE 754 semantics.
  -->

  <!-- ============================================= -->
  <!-- Division by zero producing Inf/NaN           -->
  <!-- ============================================= -->

  <test-case name="positive float divided by zero produces Inf">
    <script>expr {1.0/0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>+Inf</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="negative float divided by zero produces -Inf">
    <script>expr {-1.0/0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>-Inf</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="zero divided by zero produces NaN">
    <script>expr {0.0/0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>NaN</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="integer division by zero still errors">
    <script>expr {10/0}</script>
    <return>TCL_ERROR</return>
    <error>divide by zero</error>
    <stderr></stderr>
    <exit-code>1</exit-code>
  </test-case>

  <!-- ============================================= -->
  <!-- Fractional exponents use host pow            -->
  <!-- ============================================= -->

  <test-case name="square root via exponentiation">
    <script>expr {4.0 ** 0.5}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>2</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="negative base with fractional exponent produces NaN">
    <script>expr {-1.0 ** 0.5}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>NaN</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <!-- ============================================= -->
  <!-- Multiple operations produce correct results  -->
  <!-- ============================================= -->

  <test-case name="chained division by zero">
    <script>expr {1.0/0 + 1.0/0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>+Inf</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="Inf minus Inf via division is NaN">
    <script>expr {1.0/0 - 1.0/0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>NaN</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

  <test-case name="NaN propagates through division">
    <script>expr {(0.0/0) / 2.0}</script>
    <return>TCL_OK</return>
    <error></error>
    <stdout>NaN</stdout>
    <stderr></stderr>
    <exit-code>0</exit-code>
  </test-case>

</test-suite>
