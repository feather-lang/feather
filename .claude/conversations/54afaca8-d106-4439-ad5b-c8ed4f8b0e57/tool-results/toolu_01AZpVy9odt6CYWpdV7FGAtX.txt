     1→{
     2→  "feature": "event",
     3→  "tclsh": "tclsh",
     4→  "tests": [
     5→    {
     6→      "name": "after-1.0",
     7→      "file": "spec/tests/event/after-1.0.tcl",
     8→      "script": "# Test: after ms - blocking sleep (short delay to avoid long test)\n# This should block for 10ms then return empty string\nputs [after 10]\nputs \"done\"\n",
     9→      "stdout": "\ndone\n",
    10→      "stderr": "",
    11→      "returncode": 0
    12→    },
    13→    {
    14→      "name": "after-1.1",
    15→      "file": "spec/tests/event/after-1.1.tcl",
    16→      "script": "# Test: after 0 - zero delay should still work\nputs [after 0]\nputs \"done\"\n",
    17→      "stdout": "\ndone\n",
    18→      "stderr": "",
    19→      "returncode": 0
    20→    },
    21→    {
    22→      "name": "after-1.2",
    23→      "file": "spec/tests/event/after-1.2.tcl",
    24→      "script": "# Test: after negative - negative treated as 0\nputs [after -1]\nputs \"done\"\n",
    25→      "stdout": "\ndone\n",
    26→      "stderr": "",
    27→      "returncode": 0
    28→    },
    29→    {
    30→      "name": "after-2.0",
    31→      "file": "spec/tests/event/after-2.0.tcl",
    32→      "script": "# Test: after ms script - schedule a timer, returns an ID\nset id [after 100 {set x done}]\nputs [string match \"after#*\" $id]\n",
    33→      "stdout": "1\n",
    34→      "stderr": "",
    35→      "returncode": 0
    36→    },
    37→    {
    38→      "name": "after-2.1",
    39→      "file": "spec/tests/event/after-2.1.tcl",
    40→      "script": "# Test: after ms script - script is concatenated\nset id [after 100 set x done]\nputs [string match \"after#*\" $id]\n",
    41→      "stdout": "1\n",
    42→      "stderr": "",
    43→      "returncode": 0
    44→    },
    45→    {
    46→      "name": "after-3.0",
    47→      "file": "spec/tests/event/after-3.0.tcl",
    48→      "script": "# Test: after idle script - schedule idle callback\nset id [after idle {set x done}]\nputs [string match \"after#*\" $id]\n",
    49→      "stdout": "1\n",
    50→      "stderr": "",
    51→      "returncode": 0
    52→    },
    53→    {
    54→      "name": "after-4.0",
    55→      "file": "spec/tests/event/after-4.0.tcl",
    56→      "script": "# Test: after info - list all pending handlers\nset id1 [after 1000 {set x 1}]\nset id2 [after 2000 {set y 2}]\nset ids [after info]\nputs [expr {[lsearch -exact $ids $id1] \u003e= 0}]\nputs [expr {[lsearch -exact $ids $id2] \u003e= 0}]\nafter cancel $id1\nafter cancel $id2\n",
    57→      "stdout": "1\n1\n",
    58→      "stderr": "",
    59→      "returncode": 0
    60→    },
    61→    {
    62→      "name": "after-4.1",
    63→      "file": "spec/tests/event/after-4.1.tcl",
    64→      "script": "# Test: after info id - get info about specific handler\nset id [after 1000 {set x done}]\nset info [after info $id]\nputs [lindex $info 0]\nputs [lindex $info 1]\nafter cancel $id\n",
    65→      "stdout": "set x done\ntimer\n",
    66→      "stderr": "",
    67→      "returncode": 0
    68→    },
    69→    {
    70→      "name": "after-4.2",
    71→      "file": "spec/tests/event/after-4.2.tcl",
    72→      "script": "# Test: after info id for idle handler\nset id [after idle {set x done}]\nset info [after info $id]\nputs [lindex $info 0]\nputs [lindex $info 1]\nafter cancel $id\n",
    73→      "stdout": "set x done\nidle\n",
    74→      "stderr": "",
    75→      "returncode": 0
    76→    },
    77→    {
    78→      "name": "after-5.0",
    79→      "file": "spec/tests/event/after-5.0.tcl",
    80→      "script": "# Test: after cancel id - cancel by ID\nset id [after 1000 {set x done}]\nafter cancel $id\nputs [expr {[lsearch -exact [after info] $id] \u003c 0}]\n",
    81→      "stdout": "1\n",
    82→      "stderr": "",
    83→      "returncode": 0
    84→    },
    85→    {
    86→      "name": "after-5.1",
    87→      "file": "spec/tests/event/after-5.1.tcl",
    88→      "script": "# Test: after cancel script - cancel by script\nset id [after 1000 {set x done}]\nafter cancel {set x done}\nputs [expr {[lsearch -exact [after info] $id] \u003c 0}]\n",
    89→      "stdout": "1\n",
    90→      "stderr": "",
    91→      "returncode": 0
    92→    },
    93→    {
    94→      "name": "after-5.2",
    95→      "file": "spec/tests/event/after-5.2.tcl",
    96→      "script": "# Test: after cancel non-existent - should be no-op\nafter cancel nonexistent\nputs \"ok\"\n",
    97→      "stdout": "ok\n",
    98→      "stderr": "",
    99→      "returncode": 0
   100→    },
   101→    {
   102→      "name": "after-6.0",
   103→      "file": "spec/tests/event/after-6.0.tcl",
   104→      "script": "# Test: after ms script with vwait - timer fires and sets variable\nset done 0\nafter 10 {set done 1}\nvwait done\nputs $done\n",
   105→      "stdout": "1\n",
   106→      "stderr": "",
   107→      "returncode": 0
   108→    },
   109→    {
   110→      "name": "after-6.1",
   111→      "file": "spec/tests/event/after-6.1.tcl",
   112→      "script": "# Test: after 0 fires quickly\nset done 0\nafter 0 {set done 1}\nvwait done\nputs $done\n",
   113→      "stdout": "1\n",
   114→      "stderr": "",
   115→      "returncode": 0
   116→    },
   117→    {
   118→      "name": "after-6.2",
   119→      "file": "spec/tests/event/after-6.2.tcl",
   120→      "script": "# Test: after idle executes when event loop is idle\nset done 0\nafter idle {set done 1}\nvwait done\nputs $done\n",
   121→      "stdout": "1\n",
   122→      "stderr": "",
   123→      "returncode": 0
   124→    },
   125→    {
   126→      "name": "after-7.0",
   127→      "file": "spec/tests/event/after-7.0.tcl",
   128→      "script": "# Test: after - wrong number of args\ncatch {after} result\nputs $result\n",
   129→      "stdout": "wrong # args: should be \"after option ?arg ...?\"\n",
   130→      "stderr": "",
   131→      "returncode": 0
   132→    },
   133→    {
   134→      "name": "after-7.1",
   135→      "file": "spec/tests/event/after-7.1.tcl",
   136→      "script": "# Test: after - invalid ms\ncatch {after abc} result\nputs $result\n",
   137→      "stdout": "bad argument \"abc\": must be cancel, idle, info, or an integer\n",
   138→      "stderr": "",
   139→      "returncode": 0
   140→    },
   141→    {
   142→      "name": "after-7.2",
   143→      "file": "spec/tests/event/after-7.2.tcl",
   144→      "script": "# Test: after info - invalid id\ncatch {after info nonexistent} result\nputs $result\n",
   145→      "stdout": "event \"nonexistent\" doesn't exist\n",
   146→      "stderr": "",
   147→      "returncode": 0
   148→    },
   149→    {
   150→      "name": "fileevent-1.0",
   151→      "file": "spec/tests/event/fileevent-1.0.tcl",
   152→      "script": "# Test: fileevent readable - set handler\nset f [open [info script] r]\nfileevent $f readable {set done 1}\nset handler [fileevent $f readable]\nputs [expr {$handler ne \"\"}]\nclose $f\n",
   153→      "stdout": "1\n",
   154→      "stderr": "",
   155→      "returncode": 0
   156→    },
   157→    {
   158→      "name": "fileevent-1.1",
   159→      "file": "spec/tests/event/fileevent-1.1.tcl",
   160→      "script": "# Test: fileevent readable - get handler\nset f [open [info script] r]\nfileevent $f readable {puts hello}\nputs [fileevent $f readable]\nclose $f\n",
   161→      "stdout": "puts hello\n",
   162→      "stderr": "",
   163→      "returncode": 0
   164→    },
   165→    {
   166→      "name": "fileevent-1.2",
   167→      "file": "spec/tests/event/fileevent-1.2.tcl",
   168→      "script": "# Test: fileevent readable - clear handler with empty script\nset f [open [info script] r]\nfileevent $f readable {set done 1}\nfileevent $f readable {}\nputs [fileevent $f readable]\nclose $f\n",
   169→      "stdout": "\n",
   170→      "stderr": "",
   171→      "returncode": 0
   172→    },
   173→    {
   174→      "name": "fileevent-1.3",
   175→      "file": "spec/tests/event/fileevent-1.3.tcl",
   176→      "script": "# Test: fileevent readable - no handler returns empty\nset f [open [info script] r]\nputs [fileevent $f readable]\nclose $f\n",
   177→      "stdout": "\n",
   178→      "stderr": "",
   179→      "returncode": 0
   180→    },
   181→    {
   182→      "name": "fileevent-2.0",
   183→      "file": "spec/tests/event/fileevent-2.0.tcl",
   184→      "script": "# Test: fileevent writable - set handler\nset f [file tempfile tmp]\nfileevent $f writable {set done 1}\nset handler [fileevent $f writable]\nputs [expr {$handler ne \"\"}]\nclose $f\nfile delete $tmp\n",
   185→      "stdout": "1\n",
   186→      "stderr": "",
   187→      "returncode": 0
   188→    },
   189→    {
   190→      "name": "fileevent-2.1",
   191→      "file": "spec/tests/event/fileevent-2.1.tcl",
   192→      "script": "# Test: fileevent writable - get handler\nset f [file tempfile tmp]\nfileevent $f writable {puts hello}\nputs [fileevent $f writable]\nclose $f\nfile delete $tmp\n",
   193→      "stdout": "puts hello\n",
   194→      "stderr": "",
   195→      "returncode": 0
   196→    },
   197→    {
   198→      "name": "fileevent-3.0",
   199→      "file": "spec/tests/event/fileevent-3.0.tcl",
   200→      "script": "# Test: fileevent - wrong number of args\ncatch {fileevent} result\nputs $result\n",
   201→      "stdout": "wrong # args: should be \"fileevent channel event ?script?\"\n",
   202→      "stderr": "",
   203→      "returncode": 0
   204→    },
   205→    {
   206→      "name": "fileevent-3.1",
   207→      "file": "spec/tests/event/fileevent-3.1.tcl",
   208→      "script": "# Test: fileevent - invalid channel\ncatch {fileevent nonexistent readable} result\nputs $result\n",
   209→      "stdout": "can not find channel named \"nonexistent\"\n",
   210→      "stderr": "",
   211→      "returncode": 0
   212→    },
   213→    {
   214→      "name": "fileevent-3.2",
   215→      "file": "spec/tests/event/fileevent-3.2.tcl",
   216→      "script": "# Test: fileevent - invalid event type\nset f [open [info script] r]\ncatch {fileevent $f invalid} result\nclose $f\nputs $result\n",
   217→      "stdout": "bad event name \"invalid\": must be readable or writable\n",
   218→      "stderr": "",
   219→      "returncode": 0
   220→    },
   221→    {
   222→      "name": "update-1.0",
   223→      "file": "spec/tests/event/update-1.0.tcl",
   224→      "script": "# Test: update - process pending events\nset x 0\nafter 0 {set x 1}\nupdate\nputs $x\n",
   225→      "stdout": "1\n",
   226→      "stderr": "",
   227→      "returncode": 0
   228→    },
   229→    {
   230→      "name": "update-1.1",
   231→      "file": "spec/tests/event/update-1.1.tcl",
   232→      "script": "# Test: update idletasks - process idle callbacks\nset x 0\nafter idle {set x 1}\nupdate idletasks\nputs $x\n",
   233→      "stdout": "1\n",
   234→      "stderr": "",
   235→      "returncode": 0
   236→    },
   237→    {
   238→      "name": "update-1.2",
   239→      "file": "spec/tests/event/update-1.2.tcl",
   240→      "script": "# Test: update returns empty string\nputs [update]\n",
   241→      "stdout": "\n",
   242→      "stderr": "",
   243→      "returncode": 0
   244→    },
   245→    {
   246→      "name": "update-2.0",
   247→      "file": "spec/tests/event/update-2.0.tcl",
   248→      "script": "# Test: update - wrong args\ncatch {update invalid} result\nputs $result\n",
   249→      "stdout": "bad option \"invalid\": must be idletasks\n",
   250→      "stderr": "",
   251→      "returncode": 0
   252→    },
   253→    {
   254→      "name": "vwait-1.0",
   255→      "file": "spec/tests/event/vwait-1.0.tcl",
   256→      "script": "# Test: vwait basic - wait for variable to be set by timer\nset x \"\"\nafter 10 {set x done}\nvwait x\nputs $x\n",
   257→      "stdout": "done\n",
   258→      "stderr": "",
   259→      "returncode": 0
   260→    },
   261→    {
   262→      "name": "vwait-1.1",
   263→      "file": "spec/tests/event/vwait-1.1.tcl",
   264→      "script": "# Test: vwait returns empty string on simple form\nset x \"\"\nafter 10 {set x done}\nputs [vwait x]\n",
   265→      "stdout": "\n",
   266→      "stderr": "",
   267→      "returncode": 0
   268→    },
   269→    {
   270→      "name": "vwait-2.0",
   271→      "file": "spec/tests/event/vwait-2.0.tcl",
   272→      "script": "# Test: vwait - wrong number of args (no args)\ncatch {vwait} result\nputs $result\n",
   273→      "stdout": "\n",
   274→      "stderr": "",
   275→      "returncode": 0
   276→    }
   277→  ]
   278→}

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
