     1→#ifndef INCLUDE_TCLC_INTERNAL
     2→#define INCLUDE_TCLC_INTERNAL
     3→
     4→#include "tclc.h"
     5→
     6→// Internal forward declarations go here
     7→
     8→/**
     9→ * tcl_lookup_builtin looks up a builtin command by name.
    10→ * Returns NULL if no builtin with that name exists.
    11→ */
    12→TclBuiltinCmd tcl_lookup_builtin(const char *name, size_t len);
    13→
    14→/**
    15→ * tcl_builtin_proc implements the TCL 'proc' command.
    16→ *
    17→ * Usage:
    18→ *   proc name args body
    19→ *
    20→ * Defines a new procedure with the given name, parameter list, and body.
    21→ */
    22→TclResult tcl_builtin_proc(const TclHostOps *ops, TclInterp interp,
    23→                           TclObj cmd, TclObj args);
    24→
    25→/**
    26→ * tcl_invoke_proc invokes a user-defined procedure.
    27→ *
    28→ * Handles frame push/pop, parameter binding, and body evaluation.
    29→ */
    30→TclResult tcl_invoke_proc(const TclHostOps *ops, TclInterp interp,
    31→                          TclObj name, TclObj args);
    32→
    33→/**
    34→ * tcl_builtin_if implements the TCL 'if' command.
    35→ *
    36→ * Usage:
    37→ *   if expr1 ?then? body1 ?elseif expr2 ?then? body2 ...? ?else bodyN?
    38→ */
    39→TclResult tcl_builtin_if(const TclHostOps *ops, TclInterp interp,
    40→                          TclObj cmd, TclObj args);
    41→
    42→/**
    43→ * tcl_builtin_while implements the TCL 'while' command.
    44→ *
    45→ * Usage:
    46→ *   while test command
    47→ *
    48→ * Catches TCL_BREAK and TCL_CONTINUE from the body.
    49→ */
    50→TclResult tcl_builtin_while(const TclHostOps *ops, TclInterp interp,
    51→                             TclObj cmd, TclObj args);
    52→
    53→/**
    54→ * tcl_builtin_break implements the TCL 'break' command.
    55→ *
    56→ * Usage:
    57→ *   break
    58→ *
    59→ * Returns TCL_BREAK to exit the enclosing loop.
    60→ */
    61→TclResult tcl_builtin_break(const TclHostOps *ops, TclInterp interp,
    62→                             TclObj cmd, TclObj args);
    63→
    64→/**
    65→ * tcl_builtin_continue implements the TCL 'continue' command.
    66→ *
    67→ * Usage:
    68→ *   continue
    69→ *
    70→ * Returns TCL_CONTINUE to skip to the next loop iteration.
    71→ */
    72→TclResult tcl_builtin_continue(const TclHostOps *ops, TclInterp interp,
    73→                                TclObj cmd, TclObj args);
    74→
    75→/**
    76→ * tcl_builtin_incr implements the TCL 'incr' command.
    77→ *
    78→ * Usage:
    79→ *   incr varName ?increment?
    80→ *
    81→ * Increments varName by increment (default 1) and returns new value.
    82→ */
    83→TclResult tcl_builtin_incr(const TclHostOps *ops, TclInterp interp,
    84→                            TclObj cmd, TclObj args);
    85→
    86→/**
    87→ * tcl_builtin_llength implements the TCL 'llength' command.
    88→ *
    89→ * Usage:
    90→ *   llength list
    91→ *
    92→ * Returns the number of elements in list.
    93→ */
    94→TclResult tcl_builtin_llength(const TclHostOps *ops, TclInterp interp,
    95→                               TclObj cmd, TclObj args);
    96→
    97→/**
    98→ * tcl_builtin_lindex implements the TCL 'lindex' command.
    99→ *
   100→ * Usage:
   101→ *   lindex list index
   102→ *
   103→ * Returns the element at index in list.
   104→ */
   105→TclResult tcl_builtin_lindex(const TclHostOps *ops, TclInterp interp,
   106→                              TclObj cmd, TclObj args);
   107→
   108→// Test command for debugging
   109→TclResult tcl_builtin_run(const TclHostOps *ops, TclInterp interp,
   110→                           TclObj cmd, TclObj args);
   111→
   112→/**
   113→ * tcl_builtin_return implements the TCL 'return' command.
   114→ *
   115→ * Usage:
   116→ *   return ?-code code? ?-level level? ?result?
   117→ *
   118→ * Returns from a procedure with an optional result value.
   119→ * The -code option specifies the return code.
   120→ * The -level option controls when the code takes effect.
   121→ */
   122→TclResult tcl_builtin_return(const TclHostOps *ops, TclInterp interp,
   123→                              TclObj cmd, TclObj args);
   124→
   125→/**
   126→ * tcl_builtin_mathfunc_exp implements the tcl::mathfunc::exp function.
   127→ *
   128→ * Usage:
   129→ *   tcl::mathfunc::exp value
   130→ *
   131→ * Returns floor(e^value) for integer value.
   132→ */
   133→TclResult tcl_builtin_mathfunc_exp(const TclHostOps *ops, TclInterp interp,
   134→                                    TclObj cmd, TclObj args);
   135→
   136→/**
   137→ * tcl_builtin_error implements the TCL 'error' command.
   138→ *
   139→ * Usage:
   140→ *   error message ?info? ?code?
   141→ *
   142→ * Raises an error with the given message.
   143→ * Optional info is stored in errorInfo.
   144→ * Optional code is stored in errorCode.
   145→ */
   146→TclResult tcl_builtin_error(const TclHostOps *ops, TclInterp interp,
   147→                             TclObj cmd, TclObj args);
   148→
   149→/**
   150→ * tcl_builtin_catch implements the TCL 'catch' command.
   151→ *
   152→ * Usage:
   153→ *   catch script ?resultVar? ?optionsVar?
   154→ *
   155→ * Evaluates script and captures the return code.
   156→ * If resultVar is provided, stores the result/error in it.
   157→ * If optionsVar is provided, stores the return options dictionary.
   158→ * Returns the return code as an integer.
   159→ */
   160→TclResult tcl_builtin_catch(const TclHostOps *ops, TclInterp interp,
   161→                             TclObj cmd, TclObj args);
   162→
   163→/**
   164→ * tcl_builtin_info implements the TCL 'info' command.
   165→ *
   166→ * Usage:
   167→ *   info subcommand ?arg ...?
   168→ *
   169→ * Subcommands:
   170→ *   exists varName      - returns 1 if variable exists, 0 otherwise
   171→ *   level ?number?      - returns current level or frame info at level
   172→ *   commands ?pattern?  - returns list of command names
   173→ *   procs ?pattern?     - returns list of user-defined procedure names
   174→ *   body procname       - returns body of procedure
   175→ *   args procname       - returns argument list of procedure
   176→ */
   177→TclResult tcl_builtin_info(const TclHostOps *ops, TclInterp interp,
   178→                            TclObj cmd, TclObj args);
   179→
   180→/**
   181→ * tcl_builtin_upvar implements the TCL 'upvar' command.
   182→ *
   183→ * Usage:
   184→ *   upvar ?level? otherVar myVar ?otherVar myVar ...?
   185→ *
   186→ * Creates a link between a local variable and a variable in another frame.
   187→ * Level defaults to 1 (caller's frame). Can be a number (relative) or #N (absolute).
   188→ */
   189→TclResult tcl_builtin_upvar(const TclHostOps *ops, TclInterp interp,
   190→                             TclObj cmd, TclObj args);
   191→
   192→/**
   193→ * tcl_builtin_uplevel implements the TCL 'uplevel' command.
   194→ *
   195→ * Usage:
   196→ *   uplevel ?level? script ?arg ...?
   197→ *
   198→ * Evaluates script in the context of a calling frame.
   199→ * Level defaults to 1 (caller's frame). Can be a number (relative) or #N (absolute).
   200→ * Multiple script arguments are concatenated with spaces.
   201→ */
   202→TclResult tcl_builtin_uplevel(const TclHostOps *ops, TclInterp interp,
   203→                               TclObj cmd, TclObj args);
   204→
   205→/**
   206→ * tcl_builtin_rename implements the TCL 'rename' command.
   207→ *
   208→ * Usage:
   209→ *   rename oldName newName
   210→ *
   211→ * Renames a command from oldName to newName.
   212→ * If newName is an empty string, the command is deleted.
   213→ */
   214→TclResult tcl_builtin_rename(const TclHostOps *ops, TclInterp interp,
   215→                              TclObj cmd, TclObj args);
   216→
   217→#endif
   218→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
