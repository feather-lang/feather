     1→#include "tclc.h"
     2→#include "internal.h"
     3→
     4→// Builtin command table entry
     5→typedef struct {
     6→  const char *name;
     7→  TclBuiltinCmd cmd;
     8→} BuiltinEntry;
     9→
    10→// Table of all builtin commands
    11→static const BuiltinEntry builtins[] = {
    12→    {"set", tcl_builtin_set},
    13→    {"expr", tcl_builtin_expr},
    14→    {"proc", tcl_builtin_proc},
    15→    {"if", tcl_builtin_if},
    16→    {"while", tcl_builtin_while},
    17→    {"break", tcl_builtin_break},
    18→    {"continue", tcl_builtin_continue},
    19→    {"incr", tcl_builtin_incr},
    20→    {"llength", tcl_builtin_llength},
    21→    {"lindex", tcl_builtin_lindex},
    22→    {"run", tcl_builtin_run},
    23→    {"return", tcl_builtin_return},
    24→    {"tcl::mathfunc::exp", tcl_builtin_mathfunc_exp},
    25→    {"error", tcl_builtin_error},
    26→    {"catch", tcl_builtin_catch},
    27→    {"info", tcl_builtin_info},
    28→    {"upvar", tcl_builtin_upvar},
    29→    {"uplevel", tcl_builtin_uplevel},
    30→    {"rename", tcl_builtin_rename},
    31→    {NULL, NULL} // sentinel
    32→};
    33→
    34→// Look up a builtin command by name
    35→TclBuiltinCmd tcl_lookup_builtin(const char *name, size_t len) {
    36→  for (const BuiltinEntry *entry = builtins; entry->name != NULL; entry++) {
    37→    // Compare strings (need to check length since name might not be
    38→    // null-terminated)
    39→    const char *a = entry->name;
    40→    const char *b = name;
    41→    size_t i = 0;
    42→    while (i < len && *a && *a == *b) {
    43→      a++;
    44→      b++;
    45→      i++;
    46→    }
    47→    if (i == len && *a == '\0') {
    48→      return entry->cmd;
    49→    }
    50→  }
    51→  return NULL;
    52→}
    53→
    54→void tcl_interp_init(const TclHostOps *ops, TclInterp interp) {
    55→  // Register all builtin commands with the host, including their function pointers
    56→  for (const BuiltinEntry *entry = builtins; entry->name != NULL; entry++) {
    57→    TclObj name = ops->string.intern(interp, entry->name, tcl_strlen(entry->name));
    58→    ops->proc.register_builtin(interp, name, entry->cmd);
    59→  }
    60→}
    61→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
